import './polyfills.server.mjs';
import{a as ce,b as pe}from"./chunk-LCJW3F5M.mjs";import{a as Z,b as ee}from"./chunk-ZDDED5BI.mjs";import{a as _}from"./chunk-K24HVXRL.mjs";import"./chunk-O4YLGACB.mjs";import{a as re,b as ae}from"./chunk-HOKFZYPK.mjs";import{c as te,d as de}from"./chunk-FDGWOBZ2.mjs";import"./chunk-RWHAAWCY.mjs";import{a as se,b as le}from"./chunk-64WL663V.mjs";import{f as J,j as Y,l as ie}from"./chunk-4XDBMS2F.mjs";import"./chunk-2GLMVD5P.mjs";import{a as X}from"./chunk-3LUGQ452.mjs";import{m as W,n as H}from"./chunk-NT32ICG6.mjs";import{a as b,b as ne,c as oe}from"./chunk-CC6Y76TM.mjs";import"./chunk-ZYO4HHVP.mjs";import"./chunk-JCHCUC75.mjs";import{e as q}from"./chunk-GO24T3KU.mjs";import"./chunk-7MGJQSK6.mjs";import"./chunk-AUOO4LHJ.mjs";import{c as K,p as N,v as $}from"./chunk-2AX55QIO.mjs";import{$a as a,Ac as w,Dc as U,Ea as s,Fa as m,Fb as E,Gb as D,Kb as P,Lb as F,Nb as z,Qa as p,U as y,Wa as g,Xa as u,Ya as I,Z as L,Za as R,_ as V,_a as B,ab as l,bb as d,fb as T,hb as h,ib as f,j as S,ma as M,n as k,ob as v,sb as j,sc as G,uc as O,vb as x,w as A,xc as Q}from"./chunk-OAY366PD.mjs";import"./chunk-KRLCULJA.mjs";function he(r,n){if(r&1){let o=T();a(0,"map-marker",4),h("mapClick",function(i){L(o);let t=f(2);return V(t.handleMapClick(i))}),l()}if(r&2){let o=n.$implicit,e=f(2);p("position",o.geo_direction)("options",e.markerOptions)}}function ve(r,n){if(r&1&&(a(0,"google-map",2,3),R(2,he,1,2,"map-marker",5,I),l()),r&2){let o=f();p("options",o.options),s(2),B(o.listingArray)}}var me=(()=>{let n=class n{constructor(e){this._httpClient=e,this.options={mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!1},this.markerOptions={draggable:!1},this.apiLoaded=e.jsonp("https://maps.googleapis.com/maps/api/js?key=AIzaSyAAb4SFQe0Kigpu3EiKhR93nC-OUitTKwM","callback").pipe(k(()=>!0),A(()=>S(!1)))}ngAfterViewInit(){setTimeout(()=>{this.fitBounds()},1e3)}fitBounds(){let e=new google.maps.LatLngBounds;for(let i of this.listingArray)console.log(i.geo_direction.lat),e.extend(new google.maps.LatLng(i.geo_direction.lat,i.geo_direction.lng));this.map.fitBounds(e)}handleMapClick(e){let i=e.coords||e.latLng;if(i){let t=`https://www.google.com/maps/search/?api=1&query=${i.lat()},${i.lng()}`;window.open(t,"_blank")}}};n.\u0275fac=function(i){return new(i||n)(m(K))},n.\u0275cmp=y({type:n,selectors:[["app-map-view"]],viewQuery:function(i,t){if(i&1&&F(b,5),i&2){let c;P(c=z())&&(t.map=c.first)}},inputs:{listingArray:"listingArray",filterarray:"filterarray"},standalone:!0,features:[x],decls:4,vars:3,consts:[[1,"container","py-3"],[1,"container-map","justify-content-center","align-items-center","d-flex"],[3,"options"],["map",""],[3,"position","options","mapClick"],[3,"position","options"]],template:function(i,t){i&1&&(a(0,"div",0)(1,"div",1),g(2,ve,4,1,"google-map",2),E(3,"async"),l()()),i&2&&(s(2),u(2,D(3,1,t.apiLoaded)?2:-1))},dependencies:[w,Q,oe,b,ne],styles:[`.map-container{width:85vw!important}
`],encapsulation:2});let r=n;return r})();function ye(r,n){r&1&&d(0,"p-progressSpinner",21)}function xe(r,n){if(r&1&&(a(0,"div",18),g(1,ye,1,0,"p-progressSpinner",19),d(2,"app-list-view",20),l()),r&2){let o=f();s(1),p("ngIf",o.loading),s(1),p("listingArray",o.listingArray)("filterarray",o.filterarray)("distances",o.distances)}}function we(r,n){r&1&&d(0,"p-progressSpinner",21)}function _e(r,n){if(r&1&&(a(0,"div",18),g(1,we,1,0,"p-progressSpinner",19),d(2,"app-gallery-view",20),l()),r&2){let o=f();s(1),p("ngIf",o.loading),s(1),p("listingArray",o.listingArray)("filterarray",o.filterarray)("distances",o.distances)}}function be(r,n){r&1&&d(0,"p-progressSpinner",21)}function Ce(r,n){if(r&1&&(a(0,"div",18),g(1,be,1,0,"p-progressSpinner",19),d(2,"app-map-view",22),l()),r&2){let o=f();s(1),p("ngIf",o.loading),s(1),p("listingArray",o.listingArray)("filterarray",o.filterarray)}}var ri=(()=>{let n=class n{constructor(e,i,t,c,C,fe){this.listingservice=e,this._router=i,this.filterservice=t,this.distanceService=c,this.previousRouteService=C,this.platformId=fe,this.listingArray=[],this.filterarray=[],this.first=0,this.rows=4,this.searchQuery="",this.categories=[],this.states=[],this.state="",this.category="",this.city="",this.cities=[],this.empty=[],this.loading=!1,this.distances=[],this.stateArray=[],this.galleyView=!1,this.listView=!0,this.mapView=!1}ngOnInit(){if(console.log(this.previousRouteService.getPreviousUrl()),this.previousRouteService.getPreviousUrl()=="/city"||this.previousRouteService.getPreviousUrl()=="/posting"||this.previousRouteService.getPreviousUrl()=="/buysell"||this.previousRouteService.getPreviousUrl()=="/listing")if(U(this.platformId)){let i=localStorage.getItem("filter"),t=[];i?(t=JSON.parse(i),console.log(t),this.getFilteredListing(t[0].category,t[0].state,t[0].city),this.filteredfromService(),this.clearListing()):(this.getListing(),this.filteredfromService(),this.clearListing())}else this.getListing();else this.getListing(),this.filteredfromService(),this.clearListing();navigator.geolocation&&navigator.geolocation.getCurrentPosition(i=>{this.currentLocation={latitude:i.coords.latitude,longitude:i.coords.longitude};for(let t of this.listingArray){let c={latitude:t.geo_direction.lat,longitude:t.geo_direction.lng},C=this.distanceService.calculateDistance(this.currentLocation,c);this.distances.push(C)}this.distanceService.setCurrentLocation(this.currentLocation),this.distanceService.setDistances(this.distances).then(()=>{}).catch(t=>{console.error("Error setting distances:",t)})},i=>{console.error("Error getting user location:",i)});let e=this.distanceService.getDistances();e.length>0&&(this.distances=e),console.log(this.distances)}getListing(){this.listingservice.GetListing().subscribe({next:e=>{console.log(e),this.listingArray=e.data},error:e=>{console.log(e)}})}getFilteredListing(e,i,t){this.filterservice.getbussineses(e,i,t).subscribe({next:c=>{console.log(c),this.listingArray=c.data.businessesIds},error:c=>{console.log(c)}})}clearListing(){this.filterservice.clearListings.subscribe({next:e=>{this.listingArray=e.data,console.log(e)},error:e=>{console.log(e)}})}filteredfromService(){this.filterservice.filteredListings.subscribe({next:e=>{console.log(e),this.listingArray=e.data.businessesIds}})}showGallery(){this.galleyView=!0,this.listView=!1,this.mapView=!1}showList(){this.listView=!0,this.galleyView=!1,this.mapView=!1}showMap(){this.mapView=!0,this.galleyView=!1,this.listView=!1}onPageChange(e){this.first=e.first}};n.\u0275fac=function(i){return new(i||n)(m(_),m(N),m(X),m(ie),m(de),m(M))},n.\u0275cmp=y({type:n,selectors:[["app-listing"]],standalone:!0,features:[j([_,q]),x],decls:34,vars:6,consts:[[1,"searchBar","py-5"],[1,"container"],[1,"div-searchBar2","py-2","w-100","justify-content-center","align-items-center","d-flex"],[1,"form-group"],[1,"div-searchBar","justify-content-center","align-items-center","d-flex",2,"gap","0rem"],[1,"listing","py-5","mx-1"],[1,"spas"],[1,"title"],[1,"view","d-flex","justify-content-between"],[1,"suggest"],[1,"m-0"],[1,"views","d-flex","gap-3"],[1,"box","d-flex","gap-2",3,"ngClass","click"],[1,"pi","pi-list",2,"font-size","1.5rem"],[1,"m-0","d-none","d-lg-block"],[1,"pi","pi-image",2,"font-size","1.5rem"],[1,"pi","pi-map",2,"font-size","1.5rem"],["class","view-data"],[1,"view-data"],["class","justify-content-center align-items-center d-flex","styleClass","w-2rem h-2rem","strokeWidth","3","fill","var(--surface-ground)","animationDuration",".5s",4,"ngIf"],[3,"listingArray","filterarray","distances"],["styleClass","w-2rem h-2rem","strokeWidth","3","fill","var(--surface-ground)","animationDuration",".5s",1,"justify-content-center","align-items-center","d-flex"],[3,"listingArray","filterarray"]],template:function(i,t){i&1&&(a(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),d(5,"app-filter")(6,"p-toast")(7,"p-confirmDialog"),l()()()()(),a(8,"section",5)(9,"div",6)(10,"div",1)(11,"div",7)(12,"h3"),v(13,"Top businesses in your Area"),l()(),a(14,"div",8)(15,"div",9)(16,"h6",10),v(17,"Suggested Results:"),l()(),a(18,"div",11)(19,"div",12),h("click",function(){return t.showList()}),d(20,"i",13),a(21,"p",14),v(22,"List View"),l()(),a(23,"div",12),h("click",function(){return t.showGallery()}),d(24,"i",15),a(25,"p",14),v(26,"Gallery View"),l()(),a(27,"div",12),h("click",function(){return t.showMap()}),d(28,"i",16),a(29,"p",14),v(30,"Map View"),l()()()()()(),g(31,xe,3,4,"div",17)(32,_e,3,4,"div",17)(33,Ce,3,3,"div",17),l()),i&2&&(s(19),p("ngClass",t.listView?"active":null),s(4),p("ngClass",t.galleyView?"active":null),s(4),p("ngClass",t.mapView?"active":null),s(4),u(31,t.listView?31:-1),s(1),u(32,t.galleyView?32:-1),s(1),u(33,t.mapView?33:-1))},dependencies:[J,Y,te,pe,ce,$,W,ee,Z,w,G,O,re,me,ae,le,se,H],styles:[`@media (max-width: 767px){.searchBar{display:none}.listing{padding-top:9rem!important}.Area .container .row .col-md-6 .form-group .Search-btn{display:none}.Area .container .row .col-md-6 .d-flex .h1{font-size:18px;padding:0;margin:0}.Area .container .row .col-md-6 .d-flex .nav .nav-link .par{gap:19px!important}.Area .container .row .col-md-6 .d-flex .nav .nav-link .par p{display:none!important}.Area .container .row .col-md-6 .d-flex .nav .nav-link .par i{color:#ff8682}.Area .container .col-md-6 .div-searchBar .form-group i{color:#fff!important;background-color:#0f3d3e;width:32px;height:29px;justify-content:center;align-items:center;display:flex;left:260px;border-radius:4px;-webkit-border-radius:4px;-moz-border-radius:4px;-ms-border-radius:4px;-o-border-radius:4px}.Area .container .col-md-6 .div-searchBar .form-group input{padding:0 12px!important}.Area .container .Restaurants p{line-height:38.4px;font-size:32px;font-family:Lato,sans-serif;color:#000;font-weight:900!important}.Area .container .Restaurants .div-box-navs{justify-content:center!important;align-items:center!important;display:flex!important}.Area .container .Restaurants .nav-underline{background-color:#fff;height:80px;justify-content:center;align-items:center;display:flex;box-shadow:2px 2px 2px 1px #0003;border-radius:12px;-webkit-border-radius:12px;-moz-border-radius:12px;-ms-border-radius:12px;-o-border-radius:12px}.Area .container .Restaurants .nav-underline .nav-link.active{color:#8dd3bb}.Area .container .Restaurants ul li:not(:first-child){border-left:.6px solid #d7e2ee;margin-left:40px}.Area .container .Restaurants ul li:not(:first-child) .nav-link a:visited{color:#000}.Area .container .Restaurants ul li:not(:first-child) .nav-link a.active{color:#000}.Area .container .Restaurants ul li:not(:first-child) button{color:#000;margin:0 14px}.Area .container .Restaurants ul li:not(:first-child) button .nav-link{color:#000!important}}.sfarray{width:300px;height:222px}.map-container{width:85vw}.searchBar .container .div-searchBar2 .form-group .div-searchBar form{justify-content:center;align-items:center;display:flex;gap:10px}.searchBar .container .div-searchBar2 .form-group .div-searchBar form .clear-btn{background-color:#ffbf9d;color:#fff;border-radius:4px;-webkit-border-radius:4px;-moz-border-radius:4px;-ms-border-radius:4px;-o-border-radius:4px;width:111px;height:48px;outline:none;border:none}.searchBar .container .div-searchBar2 .form-group .div-searchBar form .Search-btn{height:48px!important;background-color:#000;color:#fff;border-radius:4px;-webkit-border-radius:4px;-moz-border-radius:4px;-ms-border-radius:4px;-o-border-radius:4px;width:111px;outline:none;border:none}ul{padding:0}i,.d-lg-block{cursor:pointer}
`],encapsulation:2});let r=n;return r})();export{ri as ListingComponent};
