import{a as se,b as le}from"./chunk-EVURVPUL.js";import{a as ce,b as pe}from"./chunk-TZ53DYKZ.js";import{a as y}from"./chunk-W7WE7BUF.js";import"./chunk-KLXPR6T4.js";import{a as C,b as ne}from"./chunk-OVFBVAGZ.js";import{a as oe,b as ae}from"./chunk-UTHP2VFF.js";import{c as ie,d as me}from"./chunk-3KFBWE3J.js";import{f as Y,j as Z,l as de}from"./chunk-M3RKTT2S.js";import{a as ee}from"./chunk-4O2QTFZ7.js";import{a as b,b as te,c as re}from"./chunk-6DAJAWBC.js";import"./chunk-TT6HVVD5.js";import"./chunk-5PA3NH23.js";import"./chunk-K6EK75OT.js";import"./chunk-N3Q5VJD2.js";import{m as J,n as X}from"./chunk-S3LGUFV4.js";import{e as H}from"./chunk-OJXW572A.js";import"./chunk-KMXITLPI.js";import{c as $,m as q,r as W}from"./chunk-DAQJKRHW.js";import{A as L,Ab as v,Ac as N,Dc as _,Eb as D,Fc as K,Hb as x,Qa as s,Ra as m,Rb as F,Sb as P,Wb as z,Xb as G,Y as w,Zb as O,aa as V,ab as p,ba as M,ca as I,gb as f,hb as u,ib as R,jb as T,kb as j,lb as a,mb as l,n as A,nb as d,qa as B,r as k,rb as E,tb as h,ub as g,vc as Q,xc as U}from"./chunk-UIKUD3CR.js";function ye(r,n){if(r&1){let o=E();a(0,"map-marker",5),h("mapClick",function(i){M(o);let t=g(2);return I(t.handleMapClick(i))}),l()}if(r&2){let o=n.$implicit,e=g(2);p("position",o.geo_direction)("options",e.markerOptions)}}function we(r,n){if(r&1&&(a(0,"google-map",2,4),T(2,ye,1,2,"map-marker",6,R),l()),r&2){let o=g();p("options",o.options),s(2),j(o.listingArray)}}var ge=(()=>{let n=class n{constructor(e,i){this._httpClient=e,this.ListingService=i,this.sim=[],this.options={mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!1},this.fisrtChange=!0,this.markerOptions={draggable:!1},this.apiLoaded=e.jsonp("https://maps.googleapis.com/maps/api/js?key=AIzaSyAAb4SFQe0Kigpu3EiKhR93nC-OUitTKwM","callback").pipe(k(()=>!0),L(()=>A(!1)))}ngAfterViewInit(){setTimeout(()=>{this.fitMapBounds()},1e3)}handleMapClick(e){let i=e.coords||e.latLng;if(i){let t=`https://www.google.com/maps/search/?api=1&query=${i.lat()},${i.lng()}`;window.open(t,"_blank")}}fitMapBounds(){let e=new google.maps.LatLngBounds;for(let i of this.listingArray)e.extend(new google.maps.LatLng(i.geo_direction.lat,i.geo_direction.lng));console.log(e),this.map.fitBounds(e)}ngOnChanges(e){console.log(e,":ghost::ghost::ghost::ghost::ghost:"),e.listingArray&&e.listingArray.currentValue&&(console.log("listing array length has changed"),this.fisrtChange||this.fitMapBounds(),this.fisrtChange=!1)}};n.\u0275fac=function(i){return new(i||n)(m($),m(y))},n.\u0275cmp=w({type:n,selectors:[["app-map-view"]],viewQuery:function(i,t){if(i&1&&G(b,5),i&2){let c;z(c=O())&&(t.map=c.first)}},inputs:{listingArray:"listingArray",filterarray:"filterarray",distances:"distances"},standalone:!0,features:[V,x],decls:6,vars:6,consts:[[1,"container","py-3"],[1,"container-map","justify-content-center","align-items-center","d-flex"],[3,"options"],[3,"listingArray","filterarray","distances"],["map",""],[3,"position","options","mapClick"],[3,"position","options"]],template:function(i,t){i&1&&(a(0,"div",0)(1,"div",1),f(2,we,4,1,"google-map",2),F(3,"async"),l()(),a(4,"section"),d(5,"app-gallery-view",3),l()),i&2&&(s(2),u(2,P(3,4,t.apiLoaded)?2:-1),s(3),p("listingArray",t.listingArray)("filterarray",t.filterarray)("distances",t.distances))},dependencies:[_,N,re,b,te,C],styles:[`.map-container{width:85vw!important}
`],encapsulation:2});let r=n;return r})();function xe(r,n){r&1&&d(0,"p-progressSpinner",21)}function _e(r,n){if(r&1&&(a(0,"div",18),f(1,xe,1,0,"p-progressSpinner",19),d(2,"app-list-view",20),l()),r&2){let o=g();s(1),p("ngIf",o.loading),s(1),p("listingArray",o.listingArray)("filterarray",o.filterarray)("distances",o.distances)}}function Ce(r,n){r&1&&d(0,"p-progressSpinner",21)}function be(r,n){if(r&1&&(a(0,"div",18),f(1,Ce,1,0,"p-progressSpinner",19),d(2,"app-gallery-view",20),l()),r&2){let o=g();s(1),p("ngIf",o.loading),s(1),p("listingArray",o.listingArray)("filterarray",o.filterarray)("distances",o.distances)}}function Se(r,n){r&1&&d(0,"p-progressSpinner",21)}function Ae(r,n){if(r&1&&(a(0,"div",18),f(1,Se,1,0,"p-progressSpinner",19),d(2,"app-map-view",22),l()),r&2){let o=g();s(1),p("ngIf",o.loading),s(1),p("listingArray",o.listingArray)("filterarray",o.filterarray)}}var oi=(()=>{let n=class n{constructor(e,i,t,c,S,fe){this.listingservice=e,this._router=i,this.filterservice=t,this.distanceService=c,this.previousRouteService=S,this.platformId=fe,this.listingArray=[],this.filterarray=[],this.first=0,this.rows=4,this.searchQuery="",this.categories=[],this.states=[],this.state="",this.category="",this.city="",this.cities=[],this.empty=[],this.loading=!1,this.distances=[],this.stateArray=[],this.galleyView=!1,this.listView=!0,this.mapView=!1}ngOnInit(){if(console.log(this.previousRouteService.getPreviousUrl()),this.previousRouteService.getPreviousUrl()=="/city"||this.previousRouteService.getPreviousUrl()=="/posting"||this.previousRouteService.getPreviousUrl()=="/buysell"||this.previousRouteService.getPreviousUrl()=="/listing")if(K(this.platformId)){let i=localStorage.getItem("filter"),t=[];i?(t=JSON.parse(i),console.log(t),this.getFilteredListing(t[0].category,t[0].state,t[0].city),this.filteredfromService(),this.clearListing()):(this.getListing(),this.filteredfromService(),this.clearListing())}else this.getListing();else this.getListing(),this.filteredfromService(),this.clearListing();navigator.geolocation&&navigator.geolocation.getCurrentPosition(i=>{this.currentLocation={latitude:i.coords.latitude,longitude:i.coords.longitude};for(let t of this.listingArray){let c={latitude:t.geo_direction.lat,longitude:t.geo_direction.lng},S=this.distanceService.calculateDistance(this.currentLocation,c);this.distances.push(S)}this.distanceService.setCurrentLocation(this.currentLocation),this.distanceService.setDistances(this.distances).then(()=>{}).catch(t=>{console.error("Error setting distances:",t)})},i=>{console.error("Error getting user location:",i)});let e=this.distanceService.getDistances();e.length>0&&(this.distances=e),console.log(this.distances)}getListing(){this.listingservice.GetListing().subscribe({next:e=>{console.log(e),this.listingArray=e.data},error:e=>{console.log(e)}})}getFilteredListing(e,i,t){this.filterservice.getbussineses(e,i,t).subscribe({next:c=>{console.log(c),this.listingArray=c.data.businessesIds},error:c=>{console.log(c)}})}clearListing(){this.filterservice.clearListings.subscribe({next:e=>{this.listingArray=e.data,console.log(e)},error:e=>{console.log(e)}})}filteredfromService(){this.filterservice.filteredListings.subscribe({next:e=>{console.log(e),this.listingArray=e.data.businessesIds}})}showGallery(){this.galleyView=!0,this.listView=!1,this.mapView=!1}showList(){this.listView=!0,this.galleyView=!1,this.mapView=!1}showMap(){this.mapView=!0,this.galleyView=!1,this.listView=!1}onPageChange(e){this.first=e.first}};n.\u0275fac=function(i){return new(i||n)(m(y),m(q),m(ee),m(Z),m(me),m(B))},n.\u0275cmp=w({type:n,selectors:[["app-listing"]],standalone:!0,features:[D([y,H]),x],decls:34,vars:6,consts:[[1,"searchBar","py-5"],[1,"container"],[1,"div-searchBar2","py-2","w-100","justify-content-center","align-items-center","d-flex"],[1,"form-group"],[1,"div-searchBar","justify-content-center","align-items-center","d-flex",2,"gap","0rem"],[1,"listing","py-5","mx-1"],[1,"spas"],[1,"title"],[1,"view","d-flex","justify-content-between"],[1,"suggest"],[1,"m-0"],[1,"views","d-flex","gap-3"],[1,"box","d-flex","gap-2",3,"ngClass","click"],[1,"pi","pi-list",2,"font-size","1.5rem"],[1,"m-0","d-none","d-lg-block"],[1,"pi","pi-image",2,"font-size","1.5rem"],[1,"pi","pi-map",2,"font-size","1.5rem"],["class","view-data"],[1,"view-data"],["class","justify-content-center align-items-center d-flex","styleClass","w-2rem h-2rem","strokeWidth","3","fill","var(--surface-ground)","animationDuration",".5s",4,"ngIf"],[3,"listingArray","filterarray","distances"],["styleClass","w-2rem h-2rem","strokeWidth","3","fill","var(--surface-ground)","animationDuration",".5s",1,"justify-content-center","align-items-center","d-flex"],[3,"listingArray","filterarray"]],template:function(i,t){i&1&&(a(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),d(5,"app-filter")(6,"p-toast")(7,"p-confirmDialog"),l()()()()(),a(8,"section",5)(9,"div",6)(10,"div",1)(11,"div",7)(12,"h3"),v(13,"Top businesses in your Area"),l()(),a(14,"div",8)(15,"div",9)(16,"h6",10),v(17,"Suggested Results:"),l()(),a(18,"div",11)(19,"div",12),h("click",function(){return t.showList()}),d(20,"i",13),a(21,"p",14),v(22,"List View"),l()(),a(23,"div",12),h("click",function(){return t.showGallery()}),d(24,"i",15),a(25,"p",14),v(26,"Gallery View"),l()(),a(27,"div",12),h("click",function(){return t.showMap()}),d(28,"i",16),a(29,"p",14),v(30,"Map View"),l()()()()()(),f(31,_e,3,4,"div",17)(32,be,3,4,"div",17)(33,Ae,3,3,"div",17),l()),i&2&&(s(19),p("ngClass",t.listView?"active":null),s(4),p("ngClass",t.galleyView?"active":null),s(4),p("ngClass",t.mapView?"active":null),s(4),u(31,t.listView?31:-1),s(1),u(32,t.galleyView?32:-1),s(1),u(33,t.mapView?33:-1))},dependencies:[Y,de,ie,le,se,W,J,pe,ce,_,Q,U,C,ge,ne,ae,oe,X],styles:[`@media (max-width: 767px){.searchBar{display:none}.listing{padding-top:9rem!important}.Area .container .row .col-md-6 .form-group .Search-btn{display:none}.Area .container .row .col-md-6 .d-flex .h1{font-size:18px;padding:0;margin:0}.Area .container .row .col-md-6 .d-flex .nav .nav-link .par{gap:19px!important}.Area .container .row .col-md-6 .d-flex .nav .nav-link .par p{display:none!important}.Area .container .row .col-md-6 .d-flex .nav .nav-link .par i{color:#ff8682}.Area .container .col-md-6 .div-searchBar .form-group i{color:#fff!important;background-color:#0f3d3e;width:32px;height:29px;justify-content:center;align-items:center;display:flex;left:260px;border-radius:4px;-webkit-border-radius:4px;-moz-border-radius:4px;-ms-border-radius:4px;-o-border-radius:4px}.Area .container .col-md-6 .div-searchBar .form-group input{padding:0 12px!important}.Area .container .Restaurants p{line-height:38.4px;font-size:32px;font-family:Lato,sans-serif;color:#000;font-weight:900!important}.Area .container .Restaurants .div-box-navs{justify-content:center!important;align-items:center!important;display:flex!important}.Area .container .Restaurants .nav-underline{background-color:#fff;height:80px;justify-content:center;align-items:center;display:flex;box-shadow:2px 2px 2px 1px #0003;border-radius:12px;-webkit-border-radius:12px;-moz-border-radius:12px;-ms-border-radius:12px;-o-border-radius:12px}.Area .container .Restaurants .nav-underline .nav-link.active{color:#8dd3bb}.Area .container .Restaurants ul li:not(:first-child){border-left:.6px solid #d7e2ee;margin-left:40px}.Area .container .Restaurants ul li:not(:first-child) .nav-link a:visited{color:#000}.Area .container .Restaurants ul li:not(:first-child) .nav-link a.active{color:#000}.Area .container .Restaurants ul li:not(:first-child) button{color:#000;margin:0 14px}.Area .container .Restaurants ul li:not(:first-child) button .nav-link{color:#000!important}}.sfarray{width:300px;height:222px}.map-container{width:85vw}.searchBar .container .div-searchBar2 .form-group .div-searchBar form{justify-content:center;align-items:center;display:flex;gap:10px}.searchBar .container .div-searchBar2 .form-group .div-searchBar form .clear-btn{background-color:#ffbf9d;color:#fff;border-radius:4px;-webkit-border-radius:4px;-moz-border-radius:4px;-ms-border-radius:4px;-o-border-radius:4px;width:111px;height:48px;outline:none;border:none}.searchBar .container .div-searchBar2 .form-group .div-searchBar form .Search-btn{height:48px!important;background-color:#000;color:#fff;border-radius:4px;-webkit-border-radius:4px;-moz-border-radius:4px;-ms-border-radius:4px;-o-border-radius:4px;width:111px;outline:none;border:none}ul{padding:0}i,.d-lg-block{cursor:pointer}
`],encapsulation:2});let r=n;return r})();export{oi as ListingComponent};
